# 实体创建系统 - 快速上手

## 5 分钟快速开始

### 第一步：开启编辑模式

1. 运行项目并进入大地图系统
2. 在开发者面板找到"开启编辑器"按钮
3. 点击按钮进入编辑模式

### 第二步：打开实体创建器

编辑模式下，左侧栏会出现三个面板：
- 📦 项目管理
- ➕ **创建实体** ← 这就是我们要用的
- 🗂️ 场景浏览器

### 第三步：创建你的第一个实体

1. 在"创建实体"面板中，你会看到不同分类的实体模板
2. 点击 🎮 "游戏玩法" 分类
3. 点击 🧑 "NPC" 卡片
4. 🎉 一个 NPC 实体已在场景中心创建！

### 第四步：编辑实体属性

创建后，实体会自动被选中，右侧"属性编辑"面板会显示其属性：

- **显示名称**：改为 "村长"
- **对话 ID**：改为你的对话 ID
- **交互半径**：调整为 80
- **坐标 X/Y**：拖动实体或直接输入数字调整位置

### 第五步：保存场景

1. 点击"导出场景布局"按钮
2. JSON 文件会自动下载
3. 将文件放到 `src/data/scenarios/` 目录

## 常用实体模板

### 🎮 游戏玩法

#### 🧑 NPC
- **用途**：可交互的角色
- **关键属性**：对话 ID、交互半径
- **提示**：记得创建对应的对话文件

#### 🚪 传送门
- **用途**：地图切换或场景内传送
- **关键属性**：目标地图、入口 ID
- **提示**：跨地图传送需要目标地图存在

#### 📍 传送点
- **用途**：传送门的目标位置
- **关键属性**：目的地 ID
- **提示**：ID 需要与传送门的目标 ID 匹配

### 🌲 环境装饰

#### 🎨 装饰物
- **用途**：使用精灵的静态装饰
- **关键属性**：资源 ID、缩放、层级
- **提示**：可添加碰撞体阻挡移动

#### ⬜ 矩形装饰
- **用途**：纯色矩形，适合原型开发
- **关键属性**：宽高、颜色
- **提示**：快速搭建场景布局

#### 🧱 障碍物
- **用途**：阻挡角色移动的碰撞体
- **关键属性**：形状、尺寸
- **提示**：默认为矩形，可选圆形

## 实用技巧

### 💡 技巧 1：精确放置

创建实体后，可以通过两种方式调整位置：
1. **拖动**：在画布上直接拖动实体
2. **输入**：在属性面板精确输入坐标

### 💡 技巧 2：快速复制

想创建相似的实体？
1. 创建第一个实体并配置好属性
2. 导出场景获得配置
3. 复制配置中的实体数据
4. 修改坐标和少量属性
5. 导入场景

### 💡 技巧 3：分层管理

使用 `zIndex` 控制渲染顺序：
- **背景** (-100 到 -50)：远景、地板
- **装饰** (-50 到 0)：树木、建筑
- **角色** (0 到 50)：玩家、NPC、敌人
- **特效** (50+)：UI、高亮、光效

### 💡 技巧 4：模块化设计

将场景分为多个区域：
1. **核心区** - 主要玩法元素
2. **装饰区** - 美术装饰
3. **边界区** - 传送门和边界

## 常见问题

### Q: 创建的实体在哪里？

A: 实体会在**场景中心**（相机当前位置）创建。如果看不到：
- 检查相机位置
- 在场景浏览器中查找
- 点击实体查看其坐标

### Q: 如何删除实体？

A: 三种方式：
1. 选中实体后，在属性面板点"删除"按钮
2. 在场景浏览器中右键 → 删除
3. 在场景浏览器中选中实体，悬停后点垃圾桶图标

### Q: 创建失败怎么办？

A: 检查控制台错误信息：
- **验证错误**：检查默认数据是否符合实体 Schema
- **资源缺失**：确保引用的资源（精灵、对话）存在
- **命令队列未初始化**：刷新页面重试

### Q: 如何批量创建实体？

A: 目前需要手动：
1. 创建第一个实体
2. 导出场景
3. 在 JSON 中复制实体数据
4. 修改坐标批量添加
5. 重新导入

## 进阶使用

### 自定义默认值

编辑 `EntityTemplateRegistry.js` 中的 `getDefaultData()`：

```javascript
getDefaultData: (mousePos) => ({
    x: mousePos?.x || 400,
    y: mousePos?.y || 300,
    name: '我的自定义 NPC',  // ← 修改这里
    config: {
        dialogueId: 'my_dialogue',  // ← 使用你的对话 ID
        spriteId: 'my_sprite',      // ← 使用你的精灵 ID
        range: 100,                  // ← 自定义范围
        scale: 1.0
    }
})
```

### 添加新模板

参考 `docs/ENTITY_CREATION_SYSTEM.md` 中的"如何添加新的实体模板"章节。

## 工作流示例

### 场景：创建一个村庄

1. **规划布局**
   - 在纸上或脑海中设计村庄布局
   - 确定建筑、NPC、传送点位置

2. **创建边界**
   - 使用"障碍物"创建地图边界
   - 使用"矩形装饰"快速标记区域

3. **添加建筑**
   - 使用"装饰物"放置房屋精灵
   - 使用"障碍物"添加建筑碰撞体

4. **放置 NPC**
   - 使用"NPC"模板创建村民
   - 配置对话 ID 和交互范围
   - 调整位置和缩放

5. **设置传送**
   - 在出入口创建"传送门"
   - 配置目标地图和入口 ID
   - 测试传送功能

6. **装饰优化**
   - 添加树木、石头等装饰
   - 调整层级（zIndex）
   - 微调位置和缩放

7. **测试和导出**
   - 关闭编辑模式测试
   - 检查碰撞、交互、传送
   - 导出场景保存

## 下一步

- 📚 阅读完整文档：`docs/ENTITY_CREATION_SYSTEM.md`
- 🎨 学习实体定义：查看 `src/game/ecs/entities/definitions/`
- 🔧 自定义模板：编辑 `EntityTemplateRegistry.js`
- 💬 提出建议：在 GitHub Issues 中反馈

祝你创建愉快！🎮
